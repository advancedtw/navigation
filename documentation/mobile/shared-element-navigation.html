<html>
<head>
    <title>Shared Element Navigation</title>
    <meta name="viewport" content="width=device-width">
    <style>
      :root {
        --primary-color: #f9858b;
        --secondary-color: #ed335f;
      }    
    </style>
    <link rel="stylesheet" href="../../css/prism.css">
    <link rel="stylesheet" href="../../css/navigation.css">
</head>
<body>
    <div id="banner">
      <a href="../.."><img alt="logo" src="../../img/logo.png" /></a>
      <a href="../native/setup.html">React Native</a>
      <a href="https://github.com/grahammendick/navigation">GitHub</a>
    </div>
    <div id="content">
        <div id="menu">
          <h2>
            <img alt="web" src="../../img/web.png" />
            React
          </h2>
          <div id="items">
            <a href="../setup.html">Setup</a>
            <a href="../hello-world.html">Hello World</a>
            <a href="../state-navigation.html">State Navigation</a>
            <a href="../navigation-data.html">Navigation Data</a>
            <a href="../routes.html">Routes</a>
            <a href="../current-data.html">Current Data</a>
            <a href="../html5-history.html">HTML5 History</a>
            <a href="../navigation-lifecycle.html">Navigation Lifecycle</a>
            <a href="../reusable-components.html">Reusable Components</a>
            <a href="../typescript.html">TypeScript</a>
            <a href="../examples.html">Examples</a>
            <h3>Mobile</h3>
            <a href="setup.html">Setup</a>
            <a href="hello-world.html">Hello World</a>
            <a href="animated-navigation.html">Animated Navigation</a>
            <a href="clean-urls.html">Clean Urls</a>
            <a href="scene-navigation-lifecycle.html">Navigation Lifecycle</a>
            <a href="shared-element-navigation.html" class="selected">Shared Element Navigation</a>
            <a href="examples.html">Examples</a>
          </div>
        </div>
        <div id="article">
            <h1>Shared Element Navigation</h1>
            <h2>Sharing Elements</h2>
            <p>
                The Navigation router lets you smoothly transition between elements that are shared across two scenes when the user navigates from one scene to the other. It's a technique common to native apps, for example, zooming into an enlarged image when a user clicks on a thumbnail in a gallery. To identify elements you want to share across two scenes, you wrap each one in a <code>SharedElement</code> component and give them both the same <code>name</code>. You pass in a <code>prop</code> holding the data you want to animate as one element transitions to the other.
            </p>
            <p>
                In our email example app, we can smooth out the navigation when a user opens an email by sharing the subject of the email between the 'inbox' scene and the 'mail' scene. We wrap the subject elements on each scene inside a <code>SharedElement</code>. The font size of the subject is smaller in the inbox than on the open email, 14px as compared to 20px. Because we need to scale the text during the navigation, we pass these font sizes, along with the subject line, into the <code>data props</code>.
            </p>
            <pre><code class="language-jsx">import {SharedElement} from 'navigation-react-mobile';

// The 'inbox' scene
&lt;SharedElement
  data={{size: 14, subject: mail.subject}}
  name={`mail${mail.id}`}>
  &lt;span>{mail.subject}&lt;/span>
&lt;/SharedElement></code></pre>
            <pre><code class="language-jsx">// The 'mail' scene
&lt;SharedElement
  data={{size: 20, subject: mail.subject}}
  name={`mail${mail.id}`}>
  &lt;span>{mail.subject}&lt;/span>
&lt;/SharedElement></code></pre>
            <h2>Animating</h2>
            <p>
                During a navigation, the <code>SharedElementMotion</code> component keeps track of elements that are shared between the two scenes. For each pair it finds, as the navigation progresses, it interpolates between the source and target element screen positions. It calls you back with a <code>style</code> parameter containing these interpolated values so you can animate the shared element. The <code>SharedElementMotion</code> component also accepts <code>onAnimating</code> and <code>onAnimated props</code> so you can style the source and target elements when the navigation starts and finishes.
            </p>
            <p>
                Returning to the email example, we create a <code>MailShared</code> component that renders a <code>SharedElementMotion</code> component. Inside the child callback function we render the email subject inside a <code>div</code>. We style the <code>div</code> using the interpolated coordinates. To make it look like the subject is moving out of the 'inbox' scene and into the 'mail' scene, we supply an <code>onAnimating prop</code> that hides the subject on these scenes when the navigation begins. An <code>onAnimated prop</code> restores their visibility when the navigation completes.
            </p>
            <pre><code class="language-jsx">import {SharedElementMotion} from 'navigation-react-mobile';

const MailShared = (props) => (
  &lt;SharedElementMotion
    onAnimating={(name, ref) => {ref.style.opacity = 0}}
    onAnimated={(name, ref) => {ref.style.opacity = 1}}
    {...props}>
    {(style, name, data) => (
      &lt;div
        key={name}
        style={{
          position: 'absolute',
          fontSize: `${data.size}px`,
          left: data.left,
          top: data.top,
          width: data.width,
          height: data.height,
          transformOrigin: 'top left',
          transform: `
            translate(${style.left - data.left}px, ${style.top - data.top}px)
            scale(${style.width / data.width}, ${style.height / data.height})
          `
        }}>
        {data.subject}
      &lt;/div>
    )}
  &lt;/SharedElementMotion>
);</code></pre>
            <p>
                We assign our <code>MailShared</code> component to the <code>sharedElementMotion prop</code> of the <code>NavigationMotion</code> component because the shared element animation has to run as part of the overall scene animation.
            </p>
            <pre><code class="language-jsx">&lt;NavigationMotion
  unmountedStyle={{opacity: 0}}
  mountedStyle={{opacity: 1}}
  crumbStyle={{opacity: 0}}
  sharedElementMotion={props => &lt;MailShared {...props} />}
  renderMotion={(style, scene, key) => (
    &lt;div
      key={key}
      style={{opacity: style.opacity}}>
      {scene}
    &lt;/div>
  )}>
&lt;/NavigationMotion></code></pre>
            <div class="Note">
                <h2>Note</h2>
                The <code>style</code> parameter of the callback contains the interpolated <code>data props</code> and screen positions. You can directly set them onto the shared element's <code>style props</code> instead of using <code>transform</code>, but the animation might be jankier.
            </div>
        </div>
    </div>
    <script type="text/javascript" src="../../js/prism.js"></script>
</body>
</html>